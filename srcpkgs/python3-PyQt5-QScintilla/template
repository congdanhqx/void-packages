# Template file for 'python3-PyQt5-QScintilla'
pkgname=python3-PyQt5-QScintilla
version=2.12.0
revision=1
wrksrc="QScintilla-${version}"
build_helper=qmake
hostmakedepends="qt5-qmake qscintilla-qt5 pkg-config python3-PyQt-builder
 qt5-host-tools python3-PyQt5-devel"
makedepends="python3-devel qscintilla-qt5-devel python3-PyQt5-devel qt5-devel"
short_desc="QScintilla Python3 bindings"
maintainer="Bo Son <boson@gmx.at>"
license="GPL-3.0-or-later"
homepage="https://www.riverbankcomputing.com/software/qscintilla/intro"
distfiles="$PYPI_SITE/Q/QScintilla/QScintilla-${version}.tar.gz"
checksum=08f9cf2c35af130730231502a550ced2fce45d22b768a43bd49b0334267aa585
CXXFLAGS="-I$XBPS_CROSS_BASE/usr/include/python$py3_ver"

do_configure() {
	mkdir -p build
	sip-build --no-make \
		--api-dir /usr/share/qt5/qsci/api/python \
		--build-dir build

	if [ "$CROSS_BUILD" ]; then
		# -I/usr/include/python$py3_ver is set by sip-build :(
		find build -name Makefile |
		xargs sed -i "s,-I\\(/usr/include\\),-I$XBPS_CROSS_BASE\\1,g"
	fi
}

do_build() {
	make -C build ${makejobs}
}

do_install() {
	make -C build DESTDIR=${DESTDIR} INSTALL_ROOT=${DESTDIR} install
}
