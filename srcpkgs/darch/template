# Template file for 'darch'
pkgname=darch
version=0.28.0
revision=2
archs="x86_64* ppc64le*"
build_style=go
go_import_path=github.com/godarch/darch
go_package=github.com/godarch/darch/pkg/cmd/darch
conf_files="/etc/darch/hooks/ssh/hook
 /etc/darch/hooks/hostname/hook
 /etc/darch/hooks/fstab/hook"
make_dirs="/var/lib/darch 0755 root root"
depends="containerd"
short_desc="Tool for building/booting stateless and immutable images, bare metal"
maintainer="Paul Knopf <pauldotknopf@gmail.com>"
license="MIT"
homepage="https://godarch.com/"
distfiles="https://github.com/godarch/darch/archive/v$version.tar.gz"
checksum=78240cc8d95e3320aa2eb057d24bfd5e1f49d485f58c5626c677e4b09e192070
go_ldflags="-X main.GitCommit=v$version -X main.Version=$version"

post_patch() {
	vsed -i -e '/install.*bin.darch/d' Makefile
}

post_install() {
	make install DESTDIR=${DESTDIR}
	vlicense LICENSE
}
